<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.5. Source terms and Distributed Loads &mdash; pyfem2 3.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyfem2 3.0 documentation" href="../index.html" />
    <link rel="up" title="5. Implementation Details" href="index.html" />
    <link rel="next" title="5.6. Assembly, Part I" href="Assembly1.html" />
    <link rel="prev" title="5.4. Boundary conditions and concentrated loads" href="Boundary1.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="source-terms-and-distributed-loads">
<h1>5.5. Source terms and Distributed Loads<a class="headerlink" href="#source-terms-and-distributed-loads" title="Permalink to this headline">¶</a></h1>
<div class="section" id="source-terms">
<h2>5.5.1. Source terms<a class="headerlink" href="#source-terms" title="Permalink to this headline">¶</a></h2>
<div class="section" id="overview">
<h3>5.5.1.1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>Source terms:</p>
<ul class="simple">
<li>are forces per unit length, area, or volume acting on the system in
solid mechanics problems, or</li>
<li>heat sources in heat transfer problems.</li>
</ul>
</div>
<div class="section" id="defining-source-terms">
<h3>5.5.1.2. Defining source terms<a class="headerlink" href="#defining-source-terms" title="Permalink to this headline">¶</a></h3>
<p>Source terms are defined in a two-dimensional list where is a sublist
defining the source term type, the region on which the source is active,
and the arguments required by the source term type. Source term types
can be one of</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="18%" />
<col width="20%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Source type</th>
<th class="head">Symbolic constant</th>
<th class="head">Valid element types</th>
<th class="head">Arguments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Heat generation</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Magnitude of the heat generation <span class="math">\(s\)</span></td>
</tr>
<tr class="row-odd"><td>Gravity</td>
<td>&nbsp;</td>
<td>All solid elements</td>
<td>Material density, components of the gravity vector</td>
</tr>
</tbody>
</table>
<p>The specifier is valid only on rectilinear problem domains and is one of
the following symbolic constants:</p>
<ul class="simple">
<li>, , , , , or . ,, correspond to the <span class="math">\(x\)</span>, <span class="math">\(y\)</span>, and
<span class="math">\(z\)</span> coordinate directions and the identifiers and to the
corresponding low and high boundaries.</li>
</ul>
<div class="section" id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<p>Heat source of magnitude <span class="math">\(10\)</span> to all nodes in the domain</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">ALL</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<p>Heat source given by to nodes on the bottom edge of a rectangular
domain:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">((</span><span class="mf">3.</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">JLO</span><span class="p">,</span> <span class="n">fun</span><span class="p">]</span>
</pre></div>
</div>
<p>Gravity load in the <span class="math">\([1,0,0]\)</span> direction for a material having
density <span class="math">\(\rho=0\)</span>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">GRAV</span><span class="p">,</span> <span class="n">ALL</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="internal-representation-of-source-terms">
<h3>5.5.1.3. Internal representation of source terms<a class="headerlink" href="#internal-representation-of-source-terms" title="Permalink to this headline">¶</a></h3>
<p>Internally, source terms for every degree of freedom in the model are
stored in a single array . is generated from the user defined
containersby the function , shown in Listing [lst:src.src.1]. is defined
in and is invoked as</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">FormatSourceTermsUDOF</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">elemap</span><span class="p">,</span> <span class="n">eletyp</span><span class="p">,</span> <span class="n">elecon</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments to have been described in previous sections. The output
from is:</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">f</span></code></td>
<td>Nodal source contributions as an array of length nd*n where nd is the number of degrees of freedom per node and n the total number of nodes. The interpretation of the source term magnitude is dependent on the element type.</td>
</tr>
</tbody>
</table>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">FormatSourceTermsUDOF</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">elemap</span><span class="p">,</span> <span class="n">eletyp</span><span class="p">,</span> <span class="n">elecon</span><span class="p">,</span> <span class="n">src</span><span class="p">):</span>
    <span class="n">numele</span> <span class="o">=</span> <span class="n">elecon</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">numnod</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ndof</span> <span class="o">=</span> <span class="n">NumberOfDOFPerNode</span><span class="p">(</span><span class="n">eletyp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numnod</span><span class="o">*</span><span class="n">ndof</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">fi</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ftype</span> <span class="o">==</span> <span class="n">SOURCE</span><span class="p">:</span>
            <span class="c1"># Heat generation</span>
            <span class="n">region</span><span class="p">,</span> <span class="n">magnitude</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">magnitude</span><span class="p">(</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]))</span>
                <span class="n">fun</span> <span class="o">=</span> <span class="n">magnitude</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">magnitude</span>
            <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="n">ALL</span><span class="p">:</span>
                <span class="n">els</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">numele</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">els</span> <span class="o">=</span> <span class="p">[</span><span class="n">elemap</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">region</span><span class="p">]</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">elecon</span><span class="p">[</span><span class="n">els</span><span class="p">])</span>
            <span class="n">f</span><span class="p">[</span><span class="n">nodes</span><span class="p">]</span> <span class="o">+=</span> <span class="n">fun</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">nodes</span><span class="p">])</span>

        <span class="k">elif</span> <span class="n">ftype</span> <span class="o">==</span> <span class="n">GRAV</span><span class="p">:</span>
            <span class="n">region</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">components</span> <span class="o">=</span> <span class="n">fi</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">components</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ndof</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Incorrect number of gravity load components&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="n">ALL</span><span class="p">:</span>
                <span class="n">els</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">numele</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">els</span> <span class="o">=</span> <span class="p">[</span><span class="n">elemap</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">region</span><span class="p">]</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">elecon</span><span class="p">[</span><span class="n">els</span><span class="p">])</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">components</span><span class="p">)</span> <span class="o">*</span> <span class="n">density</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="n">dofs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ndof</span><span class="o">*</span><span class="n">node</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndof</span><span class="p">)]</span>
                <span class="n">f</span><span class="p">[</span><span class="n">dofs</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span>

    <span class="k">return</span> <span class="n">f</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="distributed-loads">
<h2>5.5.2. Distributed loads<a class="headerlink" href="#distributed-loads" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>5.5.2.1. Overview<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Distributed loads:</p>
<ul class="simple">
<li>apply forces per unit length/area/volume on element edges, faces, or
volumes,</li>
<li>require that an appropriate distributed load type be specified.</li>
</ul>
</div>
<div class="section" id="defining-distributed-loads">
<h3>5.5.2.2. Defining distributed loads<a class="headerlink" href="#defining-distributed-loads" title="Permalink to this headline">¶</a></h3>
<p>Distributed loads are defined in a two-dimensional list where is a
sublist defining the distributed load type, the region on which the
distributed load is prescribed, and the arguments required by the
distributed load type. Distributed load types can be one of</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="12%" />
<col width="13%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Load type</th>
<th class="head">Symbolic constant</th>
<th class="head">Valid element types</th>
<th class="head">Arguments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Heat conduction</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Magnitude of the heat flux normal <span class="math">\(q_n\)</span></td>
</tr>
<tr class="row-odd"><td>Surface convection</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Convection heat transfer constant <span class="math">\(h\)</span> and the temperature of the surrounding fluid <span class="math">\(T_{\infty}\)</span></td>
</tr>
<tr class="row-even"><td>Surface tractions</td>
<td>&nbsp;</td>
<td>,</td>
<td>magnitude of the surface traction.</td>
</tr>
</tbody>
</table>
<p>The specifier defines the surfaces on which the distributed load is
applied. Define a surface by an element number and an edge identifier
label. The edge identifier is one of , , <span class="math">\(\ldots\)</span> , where is the
j<span class="math">\(^{\rm th}\)</span> element edge. Element edge numbers are defined in
Appendix [app:elem.lib]. For example, to define a surface composed of
edge 1 of elements 1, 2, and 3:</p>
<p>Alternatively, the regions</p>
<ul class="simple">
<li>to represent all nodes on the boundary</li>
<li>, , , , , or . ,, correspond to the <span class="math">\(x\)</span>, <span class="math">\(y\)</span>, and
<span class="math">\(z\)</span> coordinate directions and the identifiers and to the
corresponding low and high boundaries.</li>
</ul>
<p>can be specified to automatically generate the surface.</p>
<div class="section" id="id2">
<h4>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Heat conduction with <span class="math">\(q_n=2000\)</span> on the top boundary of a
rectangular domain:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">QCOND</span><span class="p">,</span> <span class="n">JHI</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span>
</pre></div>
</div>
<p>Heat convection with <span class="math">\(h=250\)</span> and <span class="math">\(T_{\infty}=25\)</span> on the
bottom of a rectangular domain:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">QCONV</span><span class="p">,</span> <span class="n">JLO</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>
</pre></div>
</div>
<p>Surface traction on edge 1 of elements 1, 2, and 5 with magnitude
<span class="math">\(qn=2000\)</span>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">TRAC</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">S1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">S1</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">S1</span><span class="p">)],</span> <span class="mi">2000</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="internal-representation-of-distributed-loads">
<h2>5.5.3. Internal representation of distributed loads<a class="headerlink" href="#internal-representation-of-distributed-loads" title="Permalink to this headline">¶</a></h2>
<p>Internally, distributed load data is stored in two arrays:</p>
<ul class="simple">
<li>specifies surfaces on which distributed loads are applied.</li>
<li>specifies the magnitudes of distributed loads.</li>
</ul>
<p>and are generated from the user defined container by the function ,
shown in Listing [lst:src.fmtdl]. is defined in and is invoked as</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">dltags</span><span class="p">,</span> <span class="n">dlvals</span> <span class="o">=</span> <span class="n">FormatDistributedLoadsUDOF</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">elemap</span><span class="p">,</span> <span class="n">eletyp</span><span class="p">,</span>
                                            <span class="n">elecon</span><span class="p">,</span> <span class="n">dload</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments to have described in previous sections.</p>
<p>The outputs from are the containers and . and are best explained by
example. Consider the triangular element with distributed load in Figure
[fig:src.dload]. The element connectivity is</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">elecon</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
<p>The list is:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Distributed load</span>
<span class="n">dload</span> <span class="o">=</span> <span class="p">[[</span><span class="n">T</span><span class="p">,</span> <span class="p">[(</span><span class="mi">40</span><span class="p">,</span> <span class="n">S2</span><span class="p">)],</span> <span class="n">qn</span><span class="p">]]</span>
</pre></div>
</div>
<div class="figure align-center" id="id3">
<img alt="../_images/DLoadEx.png" src="../_images/DLoadEx.png" />
<p class="caption"><span class="caption-text">Distributed load example.</span></p>
</div>
<p>The corresponding and containers are:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">dltags</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">dlvals</span> <span class="o">=</span> <span class="p">[[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span>
          <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span>
          <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span>
          <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="n">qn</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span>
          <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]]</span>
</pre></div>
</div>
<p>is the j<span class="math">\(^{\rm th}\)</span> edge of the i<span class="math">\(^{\rm th}\)</span> element.
indicates that no distributed load is applied over that edge and a
distributed is applied, otherwise.</p>
<p>is the k<span class="math">\(^{\rm th}\)</span> distributed load specifier for edge j of
element i.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">FormatDistributedLoadsUDOF</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">elemap</span><span class="p">,</span> <span class="n">eletyp</span><span class="p">,</span> <span class="n">elecon</span><span class="p">,</span> <span class="n">dload</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">mesh</span> <span class="kn">import</span> <span class="n">FindSurface</span>
    <span class="n">numele</span><span class="p">,</span> <span class="n">numnod</span> <span class="o">=</span> <span class="n">elecon</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coord</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Surface load tags and vals</span>
    <span class="n">numedge</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">EdgesPerElement</span><span class="p">(</span><span class="n">et</span><span class="p">)</span> <span class="k">for</span> <span class="n">et</span> <span class="ow">in</span> <span class="n">eletyp</span><span class="p">])</span>
    <span class="n">dltags</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">numele</span><span class="p">,</span> <span class="n">numedge</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">dlvals</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">numele</span><span class="p">,</span> <span class="n">numedge</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">dload</span><span class="p">:</span>
        <span class="n">loadtyp</span><span class="p">,</span> <span class="n">region</span> <span class="o">=</span> <span class="n">load</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">load</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">nargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">loadtyp</span> <span class="ow">in</span> <span class="p">(</span><span class="n">QCOND</span><span class="p">,</span> <span class="n">QCONV</span><span class="p">):</span>
            <span class="c1"># Surface heat flux</span>
            <span class="k">if</span> <span class="n">loadtyp</span> <span class="o">==</span> <span class="n">QCOND</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nargs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Expected 1 QCOND dload component&#39;</span><span class="p">)</span>
                    <span class="n">errors</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">loadtyp</span> <span class="o">==</span> <span class="n">QCONV</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nargs</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Expected 2 QCONV dload components&#39;</span><span class="p">)</span>
                    <span class="n">errors</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">continue</span>
            <span class="n">surf</span> <span class="o">=</span> <span class="n">FindSurface</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">elemap</span><span class="p">,</span> <span class="n">eletyp</span><span class="p">,</span> <span class="n">elecon</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">loadtyp</span> <span class="o">==</span> <span class="n">TRACTION</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">nargs</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Expected 1 TRACTION dload component&#39;</span><span class="p">)</span>
                <span class="n">errors</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            <span class="n">surf</span> <span class="o">=</span> <span class="n">FindSurface</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">elemap</span><span class="p">,</span> <span class="n">eletyp</span><span class="p">,</span> <span class="n">elecon</span><span class="p">,</span> <span class="n">region</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unrecognized dload type&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">edge</span><span class="p">)</span> <span class="ow">in</span> <span class="n">surf</span><span class="p">:</span>
            <span class="n">dltags</span><span class="p">[</span><span class="n">el</span><span class="p">,</span> <span class="n">edge</span><span class="p">]</span> <span class="o">=</span> <span class="n">loadtyp</span>
            <span class="n">dlvals</span><span class="p">[</span><span class="n">el</span><span class="p">,</span> <span class="n">edge</span><span class="p">][:</span><span class="n">nargs</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span>
    <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Stopping due to previous errors&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dltags</span><span class="p">,</span> <span class="n">dlvals</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pyfem2</a></h1>





<p>
<iframe src="https://ghbtns.com/github-btn.html?user=tjfulle&repo=pyfem2&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>




<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction/index.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/index.html">2. <code class="docutils literal"><span class="pre">pyfem2</span></code> Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ModelDefinition/index.html">3. Defining a Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ElementLibrary/index.html">4. Element Library</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">5. Implementation Details</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Overview.html">5.1. Finite element analysis stages</a></li>
<li class="toctree-l2"><a class="reference internal" href="First.html">5.2. A First Finite Element Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="InternalNodesAndElements.html">5.3. Nodes and elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="Boundary1.html">5.4. Boundary conditions and concentrated loads</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">5.5. Source terms and Distributed Loads</a></li>
<li class="toctree-l2"><a class="reference internal" href="Assembly1.html">5.6. Assembly, Part I</a></li>
<li class="toctree-l2"><a class="reference internal" href="Boundary2.html">5.7. Application of Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Truss1.html">5.8. TrussModel: A Complete Truss Program</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/index.html">6. <code class="docutils literal"><span class="pre">pyfem2</span></code> Source</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">5. Implementation Details</a><ul>
      <li>Previous: <a href="Boundary1.html" title="previous chapter">5.4. Boundary conditions and concentrated loads</a></li>
      <li>Next: <a href="Assembly1.html" title="next chapter">5.6. Assembly, Part I</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Tim Fuller.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="../_sources/Implementation/DistributedLoads.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
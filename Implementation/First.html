<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.2. A First Finite Element Program &mdash; pyfem2 3.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyfem2 3.0 documentation" href="../index.html" />
    <link rel="up" title="5. Implementation Details" href="index.html" />
    <link rel="next" title="5.3. Nodes and elements" href="InternalNodesAndElements.html" />
    <link rel="prev" title="5.1. Finite element analysis stages" href="Overview.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="a-first-finite-element-program">
<span id="firstprogram"></span><h1>5.2. A First Finite Element Program<a class="headerlink" href="#a-first-finite-element-program" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>5.2.1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A finite element program for computing the displacements in a
uniform elastic bar fixed at its origin and subject to a uniform body
load and constant point force at its end is developed.</p>
</div>
<div class="section" id="uniform-bar-program">
<h2>5.2.2. Uniform Bar Program<a class="headerlink" href="#uniform-bar-program" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problem-definition">
<h3>5.2.2.1. Problem Definition<a class="headerlink" href="#problem-definition" title="Permalink to this headline">¶</a></h3>
<p>Determine the displacements in uniform elastic bar fixed at its origin and
subject to a uniform body load and constant point force at its end, as shown,</p>
<div class="figure align-center" id="id1">
<img alt="../_images/FirstTruss.png" src="../_images/FirstTruss.png" />
<p class="caption"><span class="caption-text">Uniform truss subject to constant body load and point force. Shown is
the physical model and the 1D finite element idealization. Node
numbers are shown adjacent to nodes and range from 0 to the number of
elements <span class="math">\(N\)</span>. Node numbers are shown circled under their
element and range from 1 to <span class="math">\(N\)</span>.</span></p>
</div>
<p>The finite element equations for the elastic bar are:</p>
<div class="math">
\[k_{ij}^eu_j^e = f_i^e\]</div>
<p>where <span class="math">\(k_{ij}^e\)</span> is the constant element stiffness, given by</p>
<div class="math">
\[\begin{split}\left[k^e\right] = \frac{A_eE_e}{h_e}\begin{bmatrix}1&amp;-1\\-1&amp;1\end{bmatrix}\end{split}\]</div>
<p>and the nodal force <span class="math">\(f_i^e\)</span> is</p>
<div class="math">
\[\begin{split}\left\{f^e\right\} = \frac{q_0h}{2}\begin{Bmatrix}1\\1\end{Bmatrix}\end{split}\]</div>
<p>The assembled global equations are</p>
<div class="math">
\[\begin{split}\begin{bmatrix}
  k_{11}^1 &amp; k_{12}^1 &amp; \\
  k_{21}^1 &amp; k_{22}^1+k_{11}^2 &amp; k_{12}^2 \\
  &amp;&amp; \ddots \\
  &amp;&amp;&amp; k_{22}^{i-1}+k_{11}^i &amp; k_{12}^i \\
  &amp;&amp;&amp; k_{21}^{i} &amp; k_{22}^i+k_{11}^{i+1} &amp; k_{12}^{i+1} \\
  &amp;&amp;&amp;&amp; \ddots \\
  &amp;&amp;&amp;&amp;&amp; k_{21}^N &amp; k_{22}^N
\end{bmatrix}
\begin{Bmatrix}
  u_0 \\ u_1 \\ \vdots \\ u_i \\ u_{i+1} \\ \vdots \\ u_N
\end{Bmatrix} =
\begin{Bmatrix}
  f_0 \\ f_1 \\ \vdots \\ f_i \\ f_{i+1} \\ \vdots \\ f_N
\end{Bmatrix}\end{split}\]</div>
<p>On applying the boundary conditions, the global equations in become</p>
<div class="math">
\[\begin{split}\begin{bmatrix}
  1 &amp; 0 &amp; \\
  k_{21}^1 &amp; k_{22}^1+k_{11}^2 &amp; k_{12}^2 \\
  &amp;&amp; \ddots \\
  &amp;&amp;&amp; k_{22}^{i-1}+k_{11}^i &amp; k_{12}^i \\
  &amp;&amp;&amp; k_{21}^{i} &amp; k_{22}^i+k_{11}^{i+1} &amp; k_{12}^{i+1} \\
  &amp;&amp;&amp;&amp; \ddots \\
  &amp;&amp;&amp;&amp;&amp; k_{21}^N &amp; k_{22}^N
\end{bmatrix}
\begin{Bmatrix}
  u_0 \\ u_1 \\ \vdots \\ u_i \\ u_{i+1} \\ \vdots \\ u_N
\end{Bmatrix} =
\begin{Bmatrix}
  0 \\ f_1 \\ \vdots \\ f_i \\ f_{i+1} \\ \vdots \\ f_N+f
\end{Bmatrix}\end{split}\]</div>
<p>The global system of equations is formed and solved in the program in the
program <code class="docutils literal"><span class="pre">UniformBar</span></code>. While simplistic, the program demonstrates the
computational implementation of the preprocessing, processing, and
postprocessing steps outlined above.</p>
<p>The program is invoked as:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">elefor</span> <span class="o">=</span> <span class="n">UniformBar</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">numele</span><span class="p">)</span>
</pre></div>
</div>
<p>The arguments to <code class="docutils literal"><span class="pre">UniformBar</span></code> are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">xa</span></code></td>
<td>The coordinate location of the bar’s origin.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">xb</span></code></td>
<td>The coordinate location of the bar’s end.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">A</span></code></td>
<td>The cross sectional area of the bar.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">E</span></code></td>
<td>The Young’s modulus of the bar.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">f</span></code></td>
<td>The point force applied to the bar’s end.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">q0</span></code></td>
<td>The constant body load applied along the length of the bar.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">numele</span></code></td>
<td>Number of elements (optional, default: 10).</td>
</tr>
</tbody>
</table>
<p>The outputs from <code class="docutils literal"><span class="pre">UniformBar</span></code> are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">u</span></code></td>
<td>The nodal displacements</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">e</span></code></td>
<td>The element strains</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">elefor</span></code></td>
<td>The element forces</td>
</tr>
</tbody>
</table>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">solve</span>
<span class="k">def</span> <span class="nf">UniformBar</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">numele</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">numnod</span> <span class="o">=</span> <span class="n">numele</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">numnod</span><span class="p">)</span>
    <span class="n">elecon</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="n">el</span><span class="p">,</span> <span class="n">el</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numele</span><span class="p">)])</span>
    <span class="n">K</span><span class="p">,</span> <span class="n">F</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">numnod</span><span class="p">,</span> <span class="n">numnod</span><span class="p">)),</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numnod</span><span class="p">)</span>

    <span class="c1"># loop over elements and assemble global stiffness, force</span>
    <span class="k">for</span> <span class="n">iel</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numele</span><span class="p">):</span>
        <span class="c1"># Element length, stiffness, and force</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="n">elecon</span><span class="p">[</span><span class="n">iel</span><span class="p">]</span>
        <span class="n">xe</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">nodes</span><span class="p">]</span>
        <span class="n">he</span> <span class="o">=</span> <span class="n">xe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ke</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">E</span> <span class="o">/</span> <span class="n">he</span> <span class="o">*</span> <span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
        <span class="n">qe</span> <span class="o">=</span> <span class="n">q0</span> <span class="o">*</span> <span class="n">he</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># add contributions to global matrices</span>
        <span class="n">F</span><span class="p">[</span><span class="n">nodes</span><span class="p">]</span> <span class="o">+=</span> <span class="n">qe</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">J</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">K</span><span class="p">[</span><span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ke</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
                <span class="n">K</span><span class="p">[</span><span class="n">J</span><span class="p">,</span><span class="n">I</span><span class="p">]</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">]</span>

    <span class="c1"># Apply boundary conditions</span>
    <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">F</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>

    <span class="c1"># Solve for u</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>

    <span class="c1"># determine element forces and strains</span>
    <span class="n">elefor</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numele</span><span class="p">),</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numele</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numele</span><span class="p">):</span>
        <span class="n">du</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">elefor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">du</span>
        <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">du</span> <span class="o">/</span> <span class="n">dx</span>

    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">elefor</span>
</pre></div>
</div>
</div>
<div class="section" id="how-does-it-work">
<h3>5.2.2.2. How Does it Work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h3>
<p>This section describes each part of <code class="docutils literal"><span class="pre">UniformBar</span></code>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">solve</span>
</pre></div>
</div>
<p>These statements make the objects and the linear solver accessible to
the program.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>def UniformBar(xa, xb, A, E, f, q0, numele=10):
</pre></div>
</div>
<p>This statement defines the function to be a function of and (with the
default being 10).</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">numnod</span> <span class="o">=</span> <span class="n">numele</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">xa</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">numnod</span><span class="p">)</span>
<span class="n">elecon</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="n">el</span><span class="p">,</span> <span class="n">el</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numele</span><span class="p">)])</span>
</pre></div>
</div>
<p>These statements declare the number of nodes (one more than the number
of elements), initialize the array of nodal coordinates, and initialize
the element connectivity.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">numnod</span><span class="p">,</span> <span class="n">numnod</span><span class="p">))</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numnod</span><span class="p">)</span>
</pre></div>
</div>
<p>These statements initialize the global force and stiffness.</p>
<p>In the following loop, each element’s stiffness and force arrays are
formed and merged in to the global stiffness and force. The merging maps
the appropriate local degrees of freedom to their global counterparts.
Since nodes and elements are ordered continuously, the global DOF is the
local DOF.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">iel</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numele</span><span class="p">):</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">elecon</span><span class="p">[</span><span class="n">iel</span><span class="p">]</span>
    <span class="n">xe</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">nodes</span><span class="p">]</span>
    <span class="n">he</span> <span class="o">=</span> <span class="n">xe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ke</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">E</span> <span class="o">/</span> <span class="n">he</span> <span class="o">*</span> <span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
    <span class="n">qe</span> <span class="o">=</span> <span class="n">q0</span> <span class="o">*</span> <span class="n">he</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">F</span><span class="p">[</span><span class="n">nodes</span><span class="p">]</span> <span class="o">+=</span> <span class="n">qe</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">J</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">K</span><span class="p">[</span><span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ke</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="n">K</span><span class="p">[</span><span class="n">J</span><span class="p">,</span><span class="n">I</span><span class="p">]</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="n">I</span><span class="p">,</span><span class="n">J</span><span class="p">]</span>
</pre></div>
</div>
<p>Boundary conditions are applied setting the all but the first components
of the first row of the global stiffness to 0. The first component is
set to 1 and the first component of the global force is set to 0, in
accordance to the displacement boundary condition at the bar’s origin.
Finally, the point force is added to the last component of the global
force.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">K</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">F</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">f</span>
</pre></div>
</div>
<p>Nodal displacements are computed.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, the element forces and strains are determined and returned</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">elefor</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numele</span><span class="p">),</span> <span class="n">zeros</span><span class="p">(</span><span class="n">numele</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numele</span><span class="p">):</span>
    <span class="n">du</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">elefor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">du</span>
    <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">du</span> <span class="o">/</span> <span class="n">dx</span>
<span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">elefor</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>5.2.3. Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>In the chapters to follow, more sophisticated finite element programs
will be developed. Being more complex not withstanding, they will share
many of the same ideas and patterns of the program outlined above.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pyfem2</a></h1>





<p>
<iframe src="https://ghbtns.com/github-btn.html?user=tjfulle&repo=pyfem2&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>




<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction/index.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/index.html">2. <code class="docutils literal"><span class="pre">pyfem2</span></code> Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ModelDefinition/index.html">3. Defining a Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ElementLibrary/index.html">4. Element Library</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">5. Implementation Details</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Overview.html">5.1. Finite element analysis stages</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">5.2. A First Finite Element Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="InternalNodesAndElements.html">5.3. Nodes and elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="Boundary1.html">5.4. Boundary conditions and concentrated loads</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedLoads.html">5.5. Source terms and Distributed Loads</a></li>
<li class="toctree-l2"><a class="reference internal" href="Assembly1.html">5.6. Assembly, Part I</a></li>
<li class="toctree-l2"><a class="reference internal" href="Boundary2.html">5.7. Application of Boundary Conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="Truss1.html">5.8. TrussModel: A Complete Truss Program</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/index.html">6. <code class="docutils literal"><span class="pre">pyfem2</span></code> Source</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">5. Implementation Details</a><ul>
      <li>Previous: <a href="Overview.html" title="previous chapter">5.1. Finite element analysis stages</a></li>
      <li>Next: <a href="InternalNodesAndElements.html" title="next chapter">5.3. Nodes and elements</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Tim Fuller.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="../_sources/Implementation/First.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
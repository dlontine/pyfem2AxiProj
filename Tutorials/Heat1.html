<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2.3. Diffusive Heat Transfer &mdash; pyfem2 3.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pyfem2 3.0 documentation" href="../index.html" />
    <link rel="up" title="2. pyfem2 Tutorials" href="index.html" />
    <link rel="next" title="2.4. Plane Elasticity, 1" href="Plane1.html" />
    <link rel="prev" title="2.2. Space truss" href="Truss2.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="diffusive-heat-transfer">
<span id="heat1"></span><h1>2.3. Diffusive Heat Transfer<a class="headerlink" href="#diffusive-heat-transfer" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objectives">
<h2>2.3.1. Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">¶</a></h2>
<p>This example demonstrates the use of the <code class="docutils literal"><span class="pre">HeatTransfer2DModel</span></code> to solve a diffusive heat transfer problem.</p>
</div>
<div class="section" id="problem-description">
<h2>2.3.2. Problem description<a class="headerlink" href="#problem-description" title="Permalink to this headline">¶</a></h2>
<p>Consider the heat transfer problem for a plate with a hole. The plate
thickness is 1, and the material is isotropic with a constant thermal
conductivity <span class="math">\(k\)</span>. There is a distributed heat generation <span class="math">\(s(x,y)\)</span>
acting throughout the plate. The surface of the hole is insulated, there is a
prescribed temperature at the left and right faces, a prescribed heat flux
into the plate at the bottom face, and a convection boundary condition at the
top face.</p>
<a class="reference internal image-reference" href="../_images/heat1_1.png"><img alt="../_images/heat1_1.png" class="align-center" src="../_images/heat1_1.png" style="width: 403.2px; height: 288.0px;" /></a>
</div>
<div class="section" id="model-script">
<h2>2.3.3. Model script<a class="headerlink" href="#model-script" title="Permalink to this headline">¶</a></h2>
<p>The problem is defined and solved in <code class="docutils literal"><span class="pre">pyfem2</span></code> as follows:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">pyfem2 tutorial demo program: Diffusive heat transfer.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyfem2</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Create the model problem and read the mesh from a file</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">HeatTransfer2DModel</span><span class="p">()</span>
<span class="n">V</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;PlateWithHoleTria3Fine.g&#39;</span><span class="p">)</span>

<span class="c1"># Define an element block of diffusive heat transfer elements</span>
<span class="c1"># with material &#39;Material-1&#39;</span>
<span class="n">V</span><span class="o">.</span><span class="n">ElementBlock</span><span class="p">(</span><span class="s1">&#39;Block1&#39;</span><span class="p">,</span> <span class="n">ALL</span><span class="p">)</span>

<span class="c1"># Create a material and define the thermal conductivity</span>
<span class="n">V</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="s1">&#39;Material-1&#39;</span><span class="p">)</span>
<span class="n">V</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;Material-1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">IsotropicThermalConductivity</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">V</span><span class="o">.</span><span class="n">AssignProperties</span><span class="p">(</span><span class="s1">&#39;ElementBlock1&#39;</span><span class="p">,</span> <span class="n">DiffussiveHeatTransfer2D3</span><span class="p">,</span> <span class="s1">&#39;Material-1&#39;</span><span class="p">)</span>

<span class="c1"># Fix temperatures on left and right edge</span>
<span class="n">V</span><span class="o">.</span><span class="n">PrescribedBC</span><span class="p">(</span><span class="n">ILO</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">V</span><span class="o">.</span><span class="n">PrescribedBC</span><span class="p">(</span><span class="n">IHI</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Define surface flux on bottom edge of domain</span>
<span class="n">V</span><span class="o">.</span><span class="n">SurfaceFlux</span><span class="p">(</span><span class="n">JLO</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>

<span class="c1"># Define surface convection on top edge of domain</span>
<span class="n">Too</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">250</span>
<span class="n">V</span><span class="o">.</span><span class="n">SurfaceConvection</span><span class="p">(</span><span class="n">JHI</span><span class="p">,</span> <span class="n">Too</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>

<span class="c1"># Define a function specifying the heat generation</span>
<span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1000.</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">V</span><span class="o">.</span><span class="n">HeatGeneration</span><span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="n">fun</span><span class="p">)</span>

<span class="c1"># Solve for the unknown degrees of freedom</span>
<span class="n">V</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>

<span class="c1"># Write the results to the ExodusII output database</span>
<span class="n">V</span><span class="o">.</span><span class="n">WriteResults</span><span class="p">(</span><span class="s1">&#39;heat1.exo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="how-does-it-work">
<h2>2.3.4. How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h2>
<p>The complete code can be found in the files <code class="docutils literal"><span class="pre">pyfem2/tutorials/Heat1.py</span></code>. We now examine the preceding program in detail.</p>
<p>The first lines of the program,</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pyfem2</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>import objects from the <code class="docutils literal"><span class="pre">numpy</span></code> and <code class="docutils literal"><span class="pre">pyfem2</span></code> namespaces in to the program.
<a class="reference external" href="http://www.numpy.org">numpy</a> is a python package providing numerical data
types and procedures. The key imports from the <code class="docutils literal"><span class="pre">pyfem2</span></code> library is
the <code class="docutils literal"><span class="pre">HeatTransfer2DModel</span></code>.</p>
<p>The statement</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">V</span> <span class="o">=</span> <span class="n">HeatTransfer2DModel</span><span class="p">()</span>
</pre></div>
</div>
<p>creates the finite element model.  The finite element mesh is assigned to the problem by</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">V</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;PlateWithHoleTria3Fine.g&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>which reads the mesh definition from a
<a class="reference external" href="http://prod.sandia.gov/techlib/access-control.cgi/1992/922137.pdf">ExodusII</a> formatted file.  The mesh is composed of 1885 triangular elements</p>
<a class="reference internal image-reference" href="../_images/heat1_2.png"><img alt="../_images/heat1_2.png" class="align-center" src="../_images/heat1_2.png" style="width: 480.0px; height: 360.0px;" /></a>
<p>The finite element model <code class="docutils literal"><span class="pre">V</span></code> requires that every element in the mesh be
assigned an element type and material constitutive relations. The assignment
occurs by grouping elements of the same type together in to element blocks and
then assigning to those element blocks material and fabrication properties.
For this problem, every element in the mesh is a <code class="docutils literal"><span class="pre">DiffussiveHeatTransfer2D3</span></code>
two-dimensional diffusive heat transfer element. The element block, named
<code class="docutils literal"><span class="pre">ElementBlock1</span></code>, containing all of the elements in the mesh is created by:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">V</span><span class="o">.</span><span class="n">ElementBlock</span><span class="p">(</span><span class="s1">&#39;ElementBlock1&#39;</span><span class="p">,</span> <span class="n">ALL</span><span class="p">)</span>
</pre></div>
</div>
<p>The symbol <code class="docutils literal"><span class="pre">ALL</span></code> informs the <code class="docutils literal"><span class="pre">ElementBlock</span></code> method to assign all elements
in the mesh to the block <code class="docutils literal"><span class="pre">ElementBlock1</span></code>. Material properties are defined by
the <code class="docutils literal"><span class="pre">Material</span></code> method and elements in a block are assigned material and
fabrication properties by the <code class="docutils literal"><span class="pre">AssignProperties</span></code> method:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">V</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="s1">&#39;Material-1&#39;</span><span class="p">)</span>
<span class="n">V</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="s1">&#39;Material-1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">IsotropicThermalConductivity</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">V</span><span class="o">.</span><span class="n">AssignProperties</span><span class="p">(</span><span class="s1">&#39;Block1&#39;</span><span class="p">,</span> <span class="n">DiffussiveHeatTransfer2D3</span><span class="p">,</span> <span class="s1">&#39;Material-1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The method <code class="docutils literal"><span class="pre">AssignProperties</span></code> takes as input the name of the element block
to which properties are being assigned, the element type for elements in the
block, the material model name, and any element fabrication properties. For
<code class="docutils literal"><span class="pre">DiffussiveHeatTransfer2D3</span></code> elements, no fabrication properties are required.</p>
<p>The next step is to specify the boundary conditions <span class="math">\(T(x=-1,y)=200\)</span> and
<span class="math">\(T(x=1,y)=50\)</span>:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">V</span><span class="o">.</span><span class="n">PrescribedBC</span><span class="p">(</span><span class="n">ILO</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">V</span><span class="o">.</span><span class="n">PrescribedBC</span><span class="p">(</span><span class="n">IHI</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>The symbols <code class="docutils literal"><span class="pre">ILO</span></code> and <code class="docutils literal"><span class="pre">IHI</span></code> correspond to the <span class="math">\(x\)</span> coordinate
direction (<code class="docutils literal"><span class="pre">I</span></code>) and the identifiers <code class="docutils literal"><span class="pre">LO</span></code> and <code class="docutils literal"><span class="pre">HI</span></code> to the corresponding
low and high boundaries.</p>
<p>The surface flux on the bottom of the domain is defined by</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">V</span><span class="o">.</span><span class="n">SurfaceFlux</span><span class="p">(</span><span class="n">JLO</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
<p>and the surface convection on top edge by</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">Too</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">250</span>
<span class="n">V</span><span class="o">.</span><span class="n">SurfaceConvection</span><span class="p">(</span><span class="n">JHI</span><span class="p">,</span> <span class="n">Too</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<p>The heat generation in the body of the domain is given by <span class="math">\(1000/\sqrt{x^2+y^2}\)</span> and is assigned to the model by defining a corresponding function and passing it to the <code class="docutils literal"><span class="pre">HeatGeneration</span></code> method:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">1000.</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">V</span><span class="o">.</span><span class="n">HeatGeneration</span><span class="p">(</span><span class="n">ALL</span><span class="p">,</span> <span class="n">fun</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, the unknown temperatures are determined by solving the model and the model results are written to an ExodusII output file</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">V</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Perhaps the easiest way to view results is by:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">V</span><span class="o">.</span><span class="n">Plot2D</span><span class="p">(</span><span class="n">colorby</span><span class="o">=</span><span class="n">V</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">V.T</span></code> is the temperature determined from the call to <code class="docutils literal"><span class="pre">V.Solve()</span></code>. The result is</p>
<a class="reference internal image-reference" href="../_images/heat1_4.png"><img alt="../_images/heat1_4.png" class="align-center" src="../_images/heat1_4.png" style="width: 480.0px; height: 360.0px;" /></a>
<p>The results can also be written to an ExodusII file and viewed in
<a class="reference external" href="http://www.paraview.org">ParaView</a></p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">V</span><span class="o">.</span><span class="n">WriteResults</span><span class="p">(</span><span class="s1">&#39;heat1.exo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/heat1_3.png"><img alt="../_images/heat1_3.png" class="align-center" src="../_images/heat1_3.png" style="width: 361.8px; height: 306.0px;" /></a>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pyfem2</a></h1>





<p>
<iframe src="https://ghbtns.com/github-btn.html?user=tjfulle&repo=pyfem2&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>




<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction/index.html">1. Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. <code class="docutils literal"><span class="pre">pyfem2</span></code> Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Truss1.html">2.1. Plane truss</a></li>
<li class="toctree-l2"><a class="reference internal" href="Truss2.html">2.2. Space truss</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">2.3. Diffusive Heat Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plane1.html">2.4. Plane Elasticity, 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Plane2.html">2.5. Plane Elasticity, 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Postprocessing.html">2.6. Post processing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ModelDefinition/index.html">3. Defining a Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ElementLibrary/index.html">4. Element Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Implementation/index.html">5. Implementation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/index.html">6. <code class="docutils literal"><span class="pre">pyfem2</span></code> Source</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">2. <code class="docutils literal"><span class="pre">pyfem2</span></code> Tutorials</a><ul>
      <li>Previous: <a href="Truss2.html" title="previous chapter">2.2. Space truss</a></li>
      <li>Next: <a href="Plane1.html" title="next chapter">2.4. Plane Elasticity, 1</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Tim Fuller.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="../_sources/Tutorials/Heat1.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>